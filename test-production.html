<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Production Widget</title>
</head>
<body>
    <h1>Testing Production Mapsy Widget</h1>
    <div id="mapsy-widget"></div>

    <!-- Load from production -->
    <script src="https://mapsy-widget.nextechspires.com/mapsy-widget.js"></script>

    <script>
        // Enable detailed logging
        console.log('=== Testing Mapsy Widget Loading ===');

        // Listen for widget events
        window.addEventListener('MapsyWidgetReady', function(e) {
            console.log('✅ Widget Ready! Version:', e.detail.version);
        });

        window.addEventListener('MapsyWidgetError', function(e) {
            console.error('❌ Widget Error:', e.detail);
        });

        // Check loader configuration after a moment
        setTimeout(() => {
            if (window.MapsyWidgetLoader) {
                console.log('Loader Config:', window.MapsyWidgetLoader.config);
                console.log('Widget Loaded:', window.MapsyWidgetLoaded);

                // Check localStorage
                console.log('Cached Version:', localStorage.getItem('mapsy-widget-version'));
                console.log('Cache Time:', localStorage.getItem('mapsy-widget-version-time'));
            } else {
                console.error('MapsyWidgetLoader not found!');
            }
        }, 1000);

        // Manually test manifest fetch
        fetch('https://mapsy-widget.nextechspires.com/widget-manifest.json')
            .then(r => {
                console.log('Manual manifest fetch status:', r.status);
                return r.json();
            })
            .then(data => console.log('Manual manifest data:', data))
            .catch(err => console.error('Manual manifest error:', err));
    </script>
</body>
</html>